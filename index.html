<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Snake 3D | Premium Game</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00ffea;
            --primary-dark: #00ccb8;
            --secondary: #ff2a6d;
            --tertiary: #9d4edd;
            --dark: #0a0a1a;
            --darker: #050511;
            --light: #ffffff;
            --card-bg: rgba(15, 25, 45, 0.85);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glow: 0 0 20px rgba(0, 255, 234, 0.7);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            --radius: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Neon Background Effects */
        .neon-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.4;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 255, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 42, 109, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(157, 78, 221, 0.1) 0%, transparent 50%);
        }
        
        /* Game Container */
        .game-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
        }
        
        /* Header */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius);
            border: 1px solid rgba(0, 255, 234, 0.1);
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            animation: slideDown 0.6s ease-out;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--tertiary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--glow);
        }
        
        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: 28px;
            background: linear-gradient(90deg, var(--primary), var(--tertiary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 30px rgba(0, 255, 234, 0.5);
        }
        
        .logo-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: -5px;
        }
        
        /* Menu Button */
        .menu-btn {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: var(--glass-bg);
            border: 1px solid rgba(0, 255, 234, 0.2);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            transition: var(--transition);
            position: relative;
            z-index: 100;
        }
        
        .menu-btn:hover {
            background: rgba(0, 255, 234, 0.1);
            transform: rotate(90deg);
            box-shadow: var(--glow);
        }
        
        /* Menu Panel */
        .menu-panel {
            position: fixed;
            top: 0;
            right: -320px;
            width: 320px;
            height: 100vh;
            background: rgba(10, 15, 30, 0.95);
            backdrop-filter: blur(30px);
            z-index: 200;
            padding: 30px;
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 1px solid rgba(0, 255, 234, 0.2);
            box-shadow: -20px 0 40px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            gap: 25px;
            overflow-y: auto;
        }
        
        .menu-panel.active {
            right: 0;
        }
        
        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .menu-header h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary);
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-menu {
            background: transparent;
            border: none;
            color: var(--light);
            font-size: 20px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .close-menu:hover {
            background: rgba(255, 42, 109, 0.2);
            color: var(--secondary);
        }
        
        .menu-section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius);
            padding: 20px;
            border: 1px solid rgba(0, 255, 234, 0.1);
        }
        
        .menu-section h4 {
            color: var(--primary);
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .menu-item:last-child {
            border-bottom: none;
        }
        
        .menu-item:hover {
            color: var(--primary);
            transform: translateX(5px);
        }
        
        .menu-item i {
            width: 20px;
            text-align: center;
            margin-right: 10px;
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 199;
            display: none;
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius);
            padding: 25px;
            border: 1px solid rgba(0, 255, 234, 0.1);
            transition: var(--transition);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 234, 0.1), transparent);
            transition: left 0.6s;
        }
        
        .stat-card:hover::before {
            left: 100%;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--glow);
        }
        
        .stat-card h3 {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }
        
        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--tertiary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 20px rgba(0, 255, 234, 0.5);
        }
        
        /* Game Area */
        .game-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .canvas-container {
            flex: 1;
            position: relative;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(0, 255, 234, 0.3);
            background: linear-gradient(135deg, #0d1425 0%, #151a2e 100%);
            min-height: 500px;
        }
        
        #gameCanvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        /* Game Screens */
        .game-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 10, 20, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            text-align: center;
            z-index: 10;
            animation: fadeIn 0.5s ease-out;
        }
        
        .game-screen h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 48px;
            margin-bottom: 20px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 40px rgba(0, 255, 234, 0.7);
            animation: pulse 2s infinite;
        }
        
        .score-display {
            font-family: 'Orbitron', sans-serif;
            font-size: 42px;
            color: var(--primary);
            margin: 20px 0;
            text-shadow: 0 0 30px rgba(0, 255, 234, 0.7);
        }
        
        .difficulty-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 25px 0;
            max-width: 500px;
            width: 100%;
        }
        
        .difficulty-btn {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(0, 255, 234, 0.2);
            border-radius: var(--radius);
            color: var(--light);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .difficulty-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-color: var(--primary);
            color: var(--darker);
            box-shadow: var(--glow);
        }
        
        .difficulty-btn:hover:not(.active) {
            background: rgba(0, 255, 234, 0.1);
            transform: translateY(-3px);
        }
        
        .difficulty-btn i {
            font-size: 20px;
        }
        
        /* Control Buttons */
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .control-btn {
            padding: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 234, 0.2);
            border-radius: var(--radius);
            color: var(--light);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .control-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 234, 0.2), transparent);
            transition: left 0.6s;
        }
        
        .control-btn:hover::before {
            left: 100%;
        }
        
        .control-btn:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--glow);
        }
        
        .control-btn i {
            font-size: 20px;
            color: var(--primary);
        }
        
        /* Instructions */
        .instructions {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius);
            padding: 30px;
            border: 1px solid rgba(0, 255, 234, 0.1);
            margin-bottom: 25px;
        }
        
        .instructions h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary);
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .instructions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .instruction-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(0, 255, 234, 0.1);
        }
        
        .key {
            background: rgba(0, 255, 234, 0.1);
            color: var(--primary);
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            border: 1px solid var(--primary);
            min-width: 60px;
            text-align: center;
            text-shadow: 0 0 10px rgba(0, 255, 234, 0.5);
        }
        
        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 300;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal {
            background: linear-gradient(135deg, #0f1a30 0%, #1a2340 100%);
            border-radius: var(--radius);
            padding: 35px;
            width: 100%;
            max-width: 500px;
            border: 1px solid rgba(0, 255, 234, 0.2);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.8);
            position: relative;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .modal-header h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary);
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .close-modal {
            background: transparent;
            border: none;
            color: var(--light);
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            background: rgba(255, 42, 109, 0.2);
            color: var(--secondary);
        }
        
        .setting-item {
            margin-bottom: 25px;
        }
        
        .setting-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .setting-label span {
            color: var(--light);
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .setting-label .value {
            color: var(--primary);
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
        }
        
        .slider-container {
            position: relative;
            padding: 15px 0;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: 3px solid var(--darker);
            box-shadow: 0 0 20px rgba(0, 255, 234, 0.8);
            transition: var(--transition);
        }
        
        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(0, 255, 234, 1);
        }
        
        .score-history {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .score-entry {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            margin-bottom: 10px;
            border: 1px solid rgba(0, 255, 234, 0.1);
            transition: var(--transition);
        }
        
        .score-entry:hover {
            background: rgba(0, 255, 234, 0.05);
            transform: translateX(5px);
        }
        
        .score-rank {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary);
            font-weight: 700;
            font-size: 20px;
            width: 40px;
        }
        
        .score-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 24px;
            font-weight: 700;
            color: var(--light);
            text-shadow: 0 0 10px rgba(0, 255, 234, 0.5);
        }
        
        .score-date {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
        }
        
        /* Buttons */
        .btn {
            padding: 18px 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: var(--radius);
            color: var(--darker);
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            box-shadow: 0 10px 30px rgba(0, 255, 234, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 255, 234, 0.5);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #d91a5d);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 15px 40px rgba(255, 42, 109, 0.5);
        }
        
        /* Mobile Controls */
        .mobile-controls {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 80px);
            gap: 15px;
            margin-top: 20px;
        }
        
        .mobile-btn {
            background: var(--glass-bg);
            border: 1px solid rgba(0, 255, 234, 0.2);
            border-radius: var(--radius);
            color: var(--primary);
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .mobile-btn:active {
            background: rgba(0, 255, 234, 0.2);
            transform: scale(0.95);
        }
        
        .mobile-btn.up { grid-column: 2; grid-row: 1; }
        .mobile-btn.left { grid-column: 1; grid-row: 2; }
        .mobile-btn.right { grid-column: 3; grid-row: 2; }
        .mobile-btn.down { grid-column: 2; grid-row: 3; }
        
        /* Animations */
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 234, 0.7); }
            50% { box-shadow: 0 0 40px rgba(0, 255, 234, 1); }
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .game-container {
                max-width: 100%;
            }
            
            .logo-text {
                font-size: 24px;
            }
        }
        
        @media (max-width: 992px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .controls-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .game-screen h2 {
                font-size: 36px;
            }
            
            .score-display {
                font-size: 32px;
            }
        }
        
        @media (max-width: 768px) {
            .game-header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .logo {
                flex-direction: column;
                text-align: center;
            }
            
            .menu-panel {
                width: 100%;
                right: -100%;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .instructions-grid {
                grid-template-columns: 1fr;
            }
            
            .game-screen h2 {
                font-size: 28px;
            }
            
            .score-display {
                font-size: 24px;
            }
            
            .mobile-controls {
                display: grid;
            }
        }
        
        @media (max-width: 480px) {
            .game-container {
                padding: 10px;
            }
            
            .modal {
                padding: 25px;
            }
            
            .difficulty-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                padding: 15px 30px;
                font-size: 16px;
            }
            
            .stat-value {
                font-size: 28px;
            }
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        /* Fullscreen Styles */
        :fullscreen .game-container {
            padding: 40px;
        }
        
        :-webkit-full-screen .game-container {
            padding: 40px;
        }
        
        :-moz-full-screen .game-container {
            padding: 40px;
        }
        
        /* Selection Styling */
        ::selection {
            background: var(--primary);
            color: var(--darker);
        }
        
        /* Focus Styles */
        *:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <!-- Neon Background -->
    <div class="neon-bg"></div>
    
    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay"></div>
    
    <!-- Menu Panel -->
    <div class="menu-panel" id="menuPanel">
        <div class="menu-header">
            <h3><i class="fas fa-gamepad"></i> GAME MENU</h3>
            <button class="close-menu" id="closeMenu">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="menu-section">
            <h4><i class="fas fa-gamepad"></i> Game Controls</h4>
            <div class="menu-item" id="pauseMenuBtn">
                <span><i class="fas fa-pause"></i> Pause Game</span>
                <span class="key">P</span>
            </div>
            <div class="menu-item" id="restartMenuBtn">
                <span><i class="fas fa-redo"></i> Restart Game</span>
            </div>
            <div class="menu-item" id="fullscreenMenuBtn">
                <span><i class="fas fa-expand"></i> Fullscreen</span>
                <span class="key">F11</span>
            </div>
        </div>
        
        <div class="menu-section">
            <h4><i class="fas fa-sliders-h"></i> Settings</h4>
            <div class="menu-item" id="soundSettingsBtn">
                <span><i class="fas fa-volume-up"></i> Sound Settings</span>
            </div>
            <div class="menu-item" id="musicSettingsBtn">
                <span><i class="fas fa-music"></i> Music Settings</span>
            </div>
            <div class="menu-item" id="scoreHistoryBtn">
                <span><i class="fas fa-trophy"></i> Score History</span>
            </div>
        </div>
        
        <div class="menu-section">
            <h4><i class="fas fa-info-circle"></i> Information</h4>
            <div class="menu-item" id="howToPlayBtn">
                <span><i class="fas fa-question-circle"></i> How to Play</span>
            </div>
            <div class="menu-item" id="aboutBtn">
                <span><i class="fas fa-code"></i> About Game</span>
            </div>
        </div>
        
        <div class="menu-section">
            <h4><i class="fas fa-door-open"></i> Exit Options</h4>
            <div class="menu-item" id="exitToMenuBtn">
                <span><i class="fas fa-home"></i> Main Menu</span>
            </div>
            <div class="menu-item" id="quitGameBtn">
                <span><i class="fas fa-power-off"></i> Quit Game</span>
            </div>
        </div>
    </div>
    
    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Game Settings</h3>
                <button class="close-modal" id="closeSettings">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="setting-item">
                <div class="setting-label">
                    <span><i class="fas fa-volume-up"></i> Sound Volume</span>
                    <span class="value" id="soundValue">70%</span>
                </div>
                <div class="slider-container">
                    <input type="range" class="slider" id="soundSlider" min="0" max="100" value="70">
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-label">
                    <span><i class="fas fa-music"></i> Music Volume</span>
                    <span class="value" id="musicValue">50%</span>
                </div>
                <div class="slider-container">
                    <input type="range" class="slider" id="musicSlider" min="0" max="100" value="50">
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-label">
                    <span><i class="fas fa-tachometer-alt"></i> Game Speed</span>
                    <span class="value" id="speedValue">Normal</span>
                </div>
                <div class="slider-container">
                    <input type="range" class="slider" id="speedSlider" min="30" max="150" value="90">
                </div>
            </div>
            
            <button class="btn" id="saveSettings">
                <i class="fas fa-save"></i> SAVE SETTINGS
            </button>
        </div>
    </div>
    
    <!-- Score History Modal -->
    <div class="modal-overlay" id="scoreModal">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-trophy"></i> Score History</h3>
                <button class="close-modal" id="closeScoreModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="score-history" id="scoreHistory">
                <!-- Scores will be added here dynamically -->
            </div>
            
            <button class="btn btn-secondary" id="clearHistory">
                <i class="fas fa-trash"></i> CLEAR HISTORY
            </button>
        </div>
    </div>
    
    <!-- Main Game Container -->
    <div class="game-container">
        <!-- Header -->
        <div class="game-header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div>
                    <div class="logo-text">NEON SNAKE 3D</div>
                    <div class="logo-subtitle">PREMIUM GAMING EXPERIENCE</div>
                </div>
            </div>
            
            <button class="menu-btn" id="menuBtn">
                <i class="fas fa-ellipsis-v"></i>
            </button>
        </div>
        
        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>Current Score</h3>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat-card">
                <h3>High Score</h3>
                <div class="stat-value" id="high-score">0</div>
            </div>
            <div class="stat-card">
                <h3>Snake Length</h3>
                <div class="stat-value" id="length">3</div>
            </div>
            <div class="stat-card">
                <h3>Game Speed</h3>
                <div class="stat-value" id="speed">1x</div>
            </div>
        </div>
        
        <!-- Game Area -->
        <div class="game-area">
            <div class="canvas-container">
                <canvas id="gameCanvas"></canvas>
                
                <!-- Start Screen -->
                <div class="game-screen" id="startScreen">
                    <h2>NEON SNAKE 3D</h2>
                    <div class="score-display">READY TO PLAY?</div>
                    
                    <p>Select Difficulty Level:</p>
                    <div class="difficulty-grid">
                        <button class="difficulty-btn active" data-speed="120">
                            <i class="fas fa-baby"></i>
                            <span>Easy</span>
                        </button>
                        <button class="difficulty-btn" data-speed="90">
                            <i class="fas fa-user"></i>
                            <span>Normal</span>
                        </button>
                        <button class="difficulty-btn" data-speed="60">
                            <i class="fas fa-running"></i>
                            <span>Hard</span>
                        </button>
                        <button class="difficulty-btn" data-speed="40">
                            <i class="fas fa-skull"></i>
                            <span>Expert</span>
                        </button>
                    </div>
                    
                    <button class="btn" id="startBtn">
                        <i class="fas fa-play"></i> START GAME
                    </button>
                </div>
                
                <!-- Game Over Screen -->
                <div class="game-screen" id="gameOverScreen" style="display: none;">
                    <h2>GAME OVER</h2>
                    <div class="score-display">SCORE: <span id="finalScore">0</span></div>
                    <p>High Score: <span id="finalHighScore">0</span></p>
                    
                    <button class="btn" id="restartBtn">
                        <i class="fas fa-redo"></i> PLAY AGAIN
                    </button>
                </div>
            </div>
            
            <!-- Mobile Controls -->
            <div class="mobile-controls">
                <button class="mobile-btn up" data-direction="up">
                    <i class="fas fa-arrow-up"></i>
                </button>
                <button class="mobile-btn left" data-direction="left">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <button class="mobile-btn right" data-direction="right">
                    <i class="fas fa-arrow-right"></i>
                </button>
                <button class="mobile-btn down" data-direction="down">
                    <i class="fas fa-arrow-down"></i>
                </button>
            </div>
        </div>
        
        <!-- Control Buttons -->
        <div class="controls-grid">
            <button class="control-btn" id="pauseBtn">
                <i class="fas fa-pause"></i> PAUSE
            </button>
            <button class="control-btn" id="resetBtn">
                <i class="fas fa-undo"></i> RESET
            </button>
            <button class="control-btn" id="soundToggle">
                <i class="fas fa-volume-up"></i> SOUND ON
            </button>
            <button class="control-btn" id="musicToggle">
                <i class="fas fa-music"></i> MUSIC ON
            </button>
        </div>
        
        <!-- Instructions -->
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> HOW TO PLAY</h3>
            <div class="instructions-grid">
                <div class="instruction-item">
                    <div class="key">↑ ↓ ← →</div>
                    <span>Control snake direction (Desktop)</span>
                </div>
                <div class="instruction-item">
                    <div class="key">WASD</div>
                    <span>Alternative controls</span>
                </div>
                <div class="instruction-item">
                    <div class="key">P</div>
                    <span>Pause/Resume game</span>
                </div>
                <div class="instruction-item">
                    <div class="key">F11</div>
                    <span>Toggle fullscreen mode</span>
                </div>
                <div class="instruction-item">
                    <div class="key" style="color: var(--primary)">●</div>
                    <span>Eat food to grow and score points</span>
                </div>
                <div class="instruction-item">
                    <div class="key">ESC</div>
                    <span>Close menus and modals</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================
        // GAME INITIALIZATION
        // ============================
        
        // DOM Elements
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Game Screens
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        
        // Buttons
        const startBtn = document.getElementById('startBtn');
        const restartBtn = document.getElementById('restartBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const soundToggle = document.getElementById('soundToggle');
        const musicToggle = document.getElementById('musicToggle');
        
        // Stats Elements
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('high-score');
        const lengthElement = document.getElementById('length');
        const speedElement = document.getElementById('speed');
        const finalScoreElement = document.getElementById('finalScore');
        const finalHighScoreElement = document.getElementById('finalHighScore');
        
        // Difficulty Buttons
        const difficultyButtons = document.querySelectorAll('.difficulty-btn');
        
        // Menu Elements
        const menuBtn = document.getElementById('menuBtn');
        const menuPanel = document.getElementById('menuPanel');
        const menuOverlay = document.getElementById('menuOverlay');
        const closeMenu = document.getElementById('closeMenu');
        
        // Menu Items
        const pauseMenuBtn = document.getElementById('pauseMenuBtn');
        const restartMenuBtn = document.getElementById('restartMenuBtn');
        const fullscreenMenuBtn = document.getElementById('fullscreenMenuBtn');
        const soundSettingsBtn = document.getElementById('soundSettingsBtn');
        const musicSettingsBtn = document.getElementById('musicSettingsBtn');
        const scoreHistoryBtn = document.getElementById('scoreHistoryBtn');
        const howToPlayBtn = document.getElementById('howToPlayBtn');
        const aboutBtn = document.getElementById('aboutBtn');
        const exitToMenuBtn = document.getElementById('exitToMenuBtn');
        const quitGameBtn = document.getElementById('quitGameBtn');
        
        // Modal Elements
        const settingsModal = document.getElementById('settingsModal');
        const scoreModal = document.getElementById('scoreModal');
        const closeSettings = document.getElementById('closeSettings');
        const closeScoreModal = document.getElementById('closeScoreModal');
        const soundSlider = document.getElementById('soundSlider');
        const musicSlider = document.getElementById('musicSlider');
        const speedSlider = document.getElementById('speedSlider');
        const soundValue = document.getElementById('soundValue');
        const musicValue = document.getElementById('musicValue');
        const speedValue = document.getElementById('speedValue');
        const saveSettings = document.getElementById('saveSettings');
        const clearHistory = document.getElementById('clearHistory');
        const scoreHistory = document.getElementById('scoreHistory');
        
        // Mobile Controls
        const mobileButtons = document.querySelectorAll('.mobile-btn');
        
        // ============================
        // GAME VARIABLES
        // ============================
        let gameSpeed = 90; // milliseconds per frame
        let gridSize = 20;
        let snake = [];
        let food = {};
        let direction = 'right';
        let nextDirection = 'right';
        let gameLoop = null;
        let score = 0;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        let gamePaused = false;
        let gameRunning = false;
        let soundEnabled = true;
        let musicEnabled = true;
        let lastRenderTime = 0;
        let particles = [];
        let scoreHistoryData = JSON.parse(localStorage.getItem('snakeScoreHistory')) || [];
        
        // ============================
        // CANVAS SETUP
        // ============================
        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
            
            // Redraw if game is running
            if (gameRunning && !gamePaused) {
                draw();
            }
        }
        
        // Initial resize
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // ============================
        // GAME LOGIC
        // ============================
        
        function initGame() {
            // Reset game state
            snake = [
                {x: 10, y: 10},
                {x: 9, y: 10},
                {x: 8, y: 10}
            ];
            
            direction = 'right';
            nextDirection = 'right';
            score = 0;
            particles = [];
            
            // Update UI
            scoreElement.textContent = score;
            highScoreElement.textContent = highScore;
            lengthElement.textContent = snake.length;
            speedElement.textContent = Math.floor(150/gameSpeed) + 'x';
            
            // Generate first food
            generateFood();
            
            // Start game loop
            if (gameLoop) {
                cancelAnimationFrame(gameLoop);
            }
            
            gameRunning = true;
            gamePaused = false;
            pauseBtn.innerHTML = '<i class="fas fa-pause"></i> PAUSE';
            pauseMenuBtn.innerHTML = '<i class="fas fa-pause"></i> Pause Game';
            
            // Start fullscreen on desktop
            if (window.innerWidth > 768) {
                setTimeout(enterFullscreen, 100);
            }
            
            lastRenderTime = performance.now();
            gameLoop = requestAnimationFrame(update);
        }
        
        function generateFood() {
            let foodOnSnake;
            do {
                foodOnSnake = false;
                food = {
                    x: Math.floor(Math.random() * (canvas.width / gridSize)),
                    y: Math.floor(Math.random() * (canvas.height / gridSize))
                };
                
                // Check if food is on snake
                for (let segment of snake) {
                    if (segment.x === food.x && segment.y === food.y) {
                        foodOnSnake = true;
                        break;
                    }
                }
            } while (foodOnSnake);
            
            // Create particle effect
            createParticles(food.x * gridSize + gridSize/2, food.y * gridSize + gridSize/2, 10, '#00ffea');
        }
        
        function update(currentTime) {
            if (!gameRunning || gamePaused) {
                gameLoop = requestAnimationFrame(update);
                return;
            }
            
            // Calculate time since last update
            const secondsSinceLastRender = (currentTime - lastRenderTime) / 1000;
            
            // Control game speed
            if (secondsSinceLastRender < gameSpeed / 1000) {
                gameLoop = requestAnimationFrame(update);
                return;
            }
            
            lastRenderTime = currentTime;
            
            // Update direction
            direction = nextDirection;
            
            // Calculate new head position
            const head = {...snake[0]};
            
            switch(direction) {
                case 'up': head.y--; break;
                case 'down': head.y++; break;
                case 'left': head.x--; break;
                case 'right': head.x++; break;
            }
            
            // Check wall collision
            if (head.x < 0 || head.x >= canvas.width / gridSize || 
                head.y < 0 || head.y >= canvas.height / gridSize) {
                gameOver();
                return;
            }
            
            // Check self collision
            for (let segment of snake) {
                if (head.x === segment.x && head.y === segment.y) {
                    gameOver();
                    return;
                }
            }
            
            // Add new head to snake
            snake.unshift(head);
            
            // Check food collision
            if (head.x === food.x && head.y === food.y) {
                // Increase score
                score += 10;
                scoreElement.textContent = score;
                
                // Update high score
                if (score > highScore) {
                    highScore = score;
                    highScoreElement.textContent = highScore;
                    localStorage.setItem('snakeHighScore', highScore);
                }
                
                // Increase game speed
                if (gameSpeed > 30) {
                    gameSpeed -= 2;
                    speedElement.textContent = Math.floor(150/gameSpeed) + 'x';
                }
                
                // Generate new food
                generateFood();
                
                // Create eating effect
                createParticles(head.x * gridSize + gridSize/2, head.y * gridSize + gridSize/2, 15, '#ff2a6d');
                
                // Play sound
                if (soundEnabled) {
                    playEatSound();
                }
            } else {
                // Remove tail if no food eaten
                snake.pop();
            }
            
            // Update length display
            lengthElement.textContent = snake.length;
            
            // Draw everything
            draw();
            
            // Continue game loop
            gameLoop = requestAnimationFrame(update);
        }
        
        function gameOver() {
            gameRunning = false;
            cancelAnimationFrame(gameLoop);
            
            // Update final score displays
            finalScoreElement.textContent = score;
            finalHighScoreElement.textContent = highScore;
            
            // Save score to history
            saveScoreToHistory(score);
            
            // Show game over screen
            gameOverScreen.style.display = 'flex';
            
            // Create explosion effect
            const head = snake[0];
            createParticles(head.x * gridSize + gridSize/2, head.y * gridSize + gridSize/2, 30, '#ff2a6d');
            
            // Play game over sound
            if (soundEnabled) {
                playGameOverSound();
            }
        }
        
        // ============================
        // DRAWING FUNCTIONS
        // ============================
        
        function draw() {
            // Clear canvas with gradient background
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#0d1425');
            gradient.addColorStop(1, '#151a2e');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            drawGrid();
            
            // Draw snake
            drawSnake();
            
            // Draw food
            drawFood();
            
            // Draw particles
            drawParticles();
            
            // Draw border
            ctx.strokeStyle = 'rgba(0, 255, 234, 0.3)';
            ctx.lineWidth = 2;
            ctx.strokeRect(0, 0, canvas.width, canvas.height);
        }
        
        function drawGrid() {
            ctx.strokeStyle = 'rgba(0, 255, 234, 0.05)';
            ctx.lineWidth = 0.5;
            
            // Vertical lines
            for (let x = 0; x < canvas.width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            
            // Horizontal lines
            for (let y = 0; y < canvas.height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }
        
        function drawSnake() {
            for (let i = 0; i < snake.length; i++) {
                const segment = snake[i];
                const x = segment.x * gridSize;
                const y = segment.y * gridSize;
                const isHead = i === 0;
                
                // Create gradient for segment
                const gradient = ctx.createRadialGradient(
                    x + gridSize/2, y + gridSize/2, 0,
                    x + gridSize/2, y + gridSize/2, gridSize/1.5
                );
                
                if (isHead) {
                    // Head gradient
                    gradient.addColorStop(0, '#00ffea');
                    gradient.addColorStop(1, '#00ccb8');
                } else {
                    // Body gradient
                    const colorValue = 200 - (i / snake.length) * 100;
                    gradient.addColorStop(0, `rgb(${colorValue}, 255, ${colorValue + 55})`);
                    gradient.addColorStop(1, `rgb(${colorValue - 40}, 180, ${colorValue + 15})`);
                }
                
                // Draw segment with shadow
                ctx.shadowColor = isHead ? '#00ffea' : '#00ff88';
                ctx.shadowBlur = 15;
                
                // Draw rounded rectangle
                roundRect(ctx, x + 1, y + 1, gridSize - 2, gridSize - 2, 4);
                ctx.fillStyle = gradient;
                ctx.fill();
                
                // Draw eyes on head
                if (isHead) {
                    ctx.fillStyle = '#0a0a1a';
                    const eyeSize = 3;
                    const eyeOffset = gridSize/3;
                    
                    if (direction === 'right') {
                        ctx.fillRect(x + gridSize - 5, y + eyeOffset, eyeSize, eyeSize);
                        ctx.fillRect(x + gridSize - 5, y + gridSize - eyeOffset - eyeSize, eyeSize, eyeSize);
                    } else if (direction === 'left') {
                        ctx.fillRect(x + 2, y + eyeOffset, eyeSize, eyeSize);
                        ctx.fillRect(x + 2, y + gridSize - eyeOffset - eyeSize, eyeSize, eyeSize);
                    } else if (direction === 'up') {
                        ctx.fillRect(x + eyeOffset, y + 2, eyeSize, eyeSize);
                        ctx.fillRect(x + gridSize - eyeOffset - eyeSize, y + 2, eyeSize, eyeSize);
                    } else if (direction === 'down') {
                        ctx.fillRect(x + eyeOffset, y + gridSize - 5, eyeSize, eyeSize);
                        ctx.fillRect(x + gridSize - eyeOffset - eyeSize, y + gridSize - 5, eyeSize, eyeSize);
                    }
                }
                
                // Reset shadow
                ctx.shadowBlur = 0;
            }
        }
        
        function drawFood() {
            const x = food.x * gridSize;
            const y = food.y * gridSize;
            
            // Create glowing effect
            ctx.shadowColor = '#00ffea';
            ctx.shadowBlur = 20;
            
            // Draw food as a circle
            ctx.beginPath();
            ctx.arc(x + gridSize/2, y + gridSize/2, gridSize/2 - 2, 0, Math.PI * 2);
            const gradient = ctx.createRadialGradient(
                x + gridSize/2, y + gridSize/2, 0,
                x + gridSize/2, y + gridSize/2, gridSize/2
            );
            gradient.addColorStop(0, '#00ffea');
            gradient.addColorStop(1, '#0099cc');
            ctx.fillStyle = gradient;
            ctx.fill();
            
            // Draw inner glow
            ctx.beginPath();
            ctx.arc(x + gridSize/2, y + gridSize/2, gridSize/4, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.fill();
            
            // Reset shadow
            ctx.shadowBlur = 0;
        }
        
        function roundRect(ctx, x, y, width, height, radius) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
        }
        
        // ============================
        // PARTICLE SYSTEM
        // ============================
        
        function createParticles(x, y, count, color) {
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    life: 1.0,
                    decay: 0.02 + Math.random() * 0.03,
                    color: color,
                    size: 2 + Math.random() * 4
                });
            }
        }
        
        function drawParticles() {
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                
                // Update particle
                p.x += p.vx;
                p.y += p.vy;
                p.life -= p.decay;
                
                // Draw particle
                ctx.globalAlpha = p.life;
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
                
                // Add glow
                ctx.shadowColor = p.color;
                ctx.shadowBlur = 10;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size/2, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;
                
                // Remove dead particles
                if (p.life <= 0) {
                    particles.splice(i, 1);
                }
            }
            ctx.globalAlpha = 1.0;
        }
        
        // ============================
        // SOUND SYSTEM
        // ============================
        
        function playEatSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(659.25, audioContext.currentTime + 0.1);
                
                gainNode.gain.setValueAtTime(0.3 * (soundSlider.value / 100), audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (e) {
                // Audio not supported
            }
        }
        
        function playGameOverSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(349.23, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(174.61, audioContext.currentTime + 0.5);
                
                gainNode.gain.setValueAtTime(0.3 * (soundSlider.value / 100), audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                // Audio not supported
            }
        }
        
        // ============================
        // SCORE HISTORY
        // ============================
        
        function saveScoreToHistory(score) {
            const scoreEntry = {
                score: score,
                date: new Date().toLocaleDateString(),
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
            };
            
            scoreHistoryData.unshift(scoreEntry);
            
            // Keep only top 10 scores
            if (scoreHistoryData.length > 10) {
                scoreHistoryData = scoreHistoryData.slice(0, 10);
            }
            
            localStorage.setItem('snakeScoreHistory', JSON.stringify(scoreHistoryData));
            updateScoreHistoryDisplay();
        }
        
        function updateScoreHistoryDisplay() {
            scoreHistory.innerHTML = '';
            
            if (scoreHistoryData.length === 0) {
                scoreHistory.innerHTML = '<div style="text-align: center; padding: 30px; color: rgba(255,255,255,0.7)">No scores yet. Play a game!</div>';
                return;
            }
            
            scoreHistoryData.forEach((entry, index) => {
                const scoreEntry = document.createElement('div');
                scoreEntry.className = 'score-entry';
                scoreEntry.innerHTML = `
                    <div class="score-rank">${index + 1}</div>
                    <div class="score-value">${entry.score}</div>
                    <div class="score-date">${entry.date} ${entry.time}</div>
                `;
                scoreHistory.appendChild(scoreEntry);
            });
        }
        
        // ============================
        // FULLSCREEN FUNCTIONALITY
        // ============================
        
        function enterFullscreen() {
            const element = document.documentElement;
            if (element.requestFullscreen) {
                element.requestFullscreen();
            } else if (element.mozRequestFullScreen) {
                element.mozRequestFullScreen();
            } else if (element.webkitRequestFullscreen) {
                element.webkitRequestFullscreen();
            } else if (element.msRequestFullscreen) {
                element.msRequestFullscreen();
            }
        }
        
        function exitFullscreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                enterFullscreen();
            } else {
                exitFullscreen();
            }
        }
        
        // ============================
        // MENU FUNCTIONALITY
        // ============================
        
        function toggleMenu() {
            menuPanel.classList.toggle('active');
            menuOverlay.style.display = menuPanel.classList.contains('active') ? 'block' : 'none';
        }
        
        // ============================
        // SETTINGS FUNCTIONALITY
        // ============================
        
        function updateSettingsDisplay() {
            soundValue.textContent = `${soundSlider.value}%`;
            musicValue.textContent = `${musicSlider.value}%`;
            
            const speedVal = parseInt(speedSlider.value);
            let speedText = 'Custom';
            if (speedVal >= 120) speedText = 'Very Easy';
            else if (speedVal >= 100) speedText = 'Easy';
            else if (speedVal >= 80) speedText = 'Normal';
            else if (speedVal >= 60) speedText = 'Hard';
            else if (speedVal >= 40) speedText = 'Expert';
            else speedText = 'Insane';
            
            speedValue.textContent = speedText;
        }
        
        // ============================
        // EVENT LISTENERS
        // ============================
        
        // Game Controls
        startBtn.addEventListener('click', () => {
            startScreen.style.display = 'none';
            initGame();
        });
        
        restartBtn.addEventListener('click', () => {
            gameOverScreen.style.display = 'none';
            initGame();
        });
        
        pauseBtn.addEventListener('click', () => {
            if (!gameRunning && !gamePaused) return;
            
            gamePaused = !gamePaused;
            
            if (gamePaused) {
                pauseBtn.innerHTML = '<i class="fas fa-play"></i> RESUME';
                pauseMenuBtn.innerHTML = '<i class="fas fa-play"></i> Resume Game';
            } else {
                pauseBtn.innerHTML = '<i class="fas fa-pause"></i> PAUSE';
                pauseMenuBtn.innerHTML = '<i class="fas fa-pause"></i> Pause Game';
                lastRenderTime = performance.now();
                gameLoop = requestAnimationFrame(update);
            }
        });
        
        resetBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to reset the game?')) {
                if (gameRunning) {
                    cancelAnimationFrame(gameLoop);
                    gameRunning = false;
                }
                initGame();
                gameOverScreen.style.display = 'none';
                startScreen.style.display = 'none';
            }
        });
        
        soundToggle.addEventListener('click', () => {
            soundEnabled = !soundEnabled;
            soundToggle.innerHTML = soundEnabled ? 
                '<i class="fas fa-volume-up"></i> SOUND ON' : 
                '<i class="fas fa-volume-mute"></i> SOUND OFF';
        });
        
        musicToggle.addEventListener('click', () => {
            musicEnabled = !musicEnabled;
            musicToggle.innerHTML = musicEnabled ? 
                '<i class="fas fa-music"></i> MUSIC ON' : 
                '<i class="fas fa-music"></i> MUSIC OFF';
        });
        
        // Difficulty Selection
        difficultyButtons.forEach(button => {
            button.addEventListener('click', () => {
                difficultyButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                gameSpeed = parseInt(button.getAttribute('data-speed'));
                speedSlider.value = gameSpeed;
                speedElement.textContent = Math.floor(150/gameSpeed) + 'x';
                updateSettingsDisplay();
            });
        });
        
        // Menu Controls
        menuBtn.addEventListener('click', toggleMenu);
        closeMenu.addEventListener('click', toggleMenu);
        menuOverlay.addEventListener('click', toggleMenu);
        
        pauseMenuBtn.addEventListener('click', () => {
            pauseBtn.click();
            toggleMenu();
        });
        
        restartMenuBtn.addEventListener('click', () => {
            resetBtn.click();
            toggleMenu();
        });
        
        fullscreenMenuBtn.addEventListener('click', () => {
            toggleFullscreen();
            toggleMenu();
        });
        
        exitToMenuBtn.addEventListener('click', () => {
            if (gameRunning) {
                cancelAnimationFrame(gameLoop);
                gameRunning = false;
            }
            gameOverScreen.style.display = 'none';
            startScreen.style.display = 'flex';
            toggleMenu();
        });
        
        quitGameBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to quit the game?')) {
                if (gameRunning) {
                    cancelAnimationFrame(gameLoop);
                }
                alert('Thanks for playing Neon Snake 3D!');
                toggleMenu();
            }
        });
        
        soundSettingsBtn.addEventListener('click', () => {
            settingsModal.style.display = 'flex';
            toggleMenu();
        });
        
        musicSettingsBtn.addEventListener('click', () => {
            settingsModal.style.display = 'flex';
            toggleMenu();
        });
        
        scoreHistoryBtn.addEventListener('click', () => {
            scoreModal.style.display = 'flex';
            toggleMenu();
        });
        
        howToPlayBtn.addEventListener('click', () => {
            alert(`HOW TO PLAY NEON SNAKE 3D:\n\n• Use ARROW KEYS or WASD to control the snake\n• Eat the glowing blue food to grow longer\n• Avoid hitting walls or yourself\n• Game speeds up as you score points\n• Press P to pause/resume\n• Press F11 for fullscreen\n• Mobile: Use on-screen buttons\n\nSCORING:\n• Each food: +10 points\n• Speed increases every 5 foods\n• Try to beat your high score!`);
            toggleMenu();
        });
        
        aboutBtn.addEventListener('click', () => {
            alert(`NEON SNAKE 3D - PREMIUM EDITION\n\nVersion: 2.0.0\n\nA modern 3D snake game with:\n• Neon visual effects\n• Particle systems\n• Responsive design\n• Score history\n• Sound settings\n• Multiple difficulty levels\n• Mobile support\n\nCreated with HTML5 Canvas & JavaScript\n© 2023 Premium Gaming Studio`);
            toggleMenu();
        });
        
        // Modal Controls
        closeSettings.addEventListener('click', () => {
            settingsModal.style.display = 'none';
        });
        
        closeScoreModal.addEventListener('click', () => {
            scoreModal.style.display = 'none';
        });
        
        soundSlider.addEventListener('input', () => {
            updateSettingsDisplay();
        });
        
        musicSlider.addEventListener('input', () => {
            updateSettingsDisplay();
        });
        
        speedSlider.addEventListener('input', () => {
            updateSettingsDisplay();
            gameSpeed = parseInt(speedSlider.value);
            speedElement.textContent = Math.floor(150/gameSpeed) + 'x';
        });
        
        saveSettings.addEventListener('click', () => {
            localStorage.setItem('snakeSettings', JSON.stringify({
                soundVolume: soundSlider.value,
                musicVolume: musicSlider.value,
                gameSpeed: speedSlider.value
            }));
            alert('Settings saved successfully!');
            settingsModal.style.display = 'none';
        });
        
        clearHistory.addEventListener('click', () => {
            if (confirm('Are you sure you want to clear all score history?')) {
                scoreHistoryData = [];
                localStorage.removeItem('snakeScoreHistory');
                updateScoreHistoryDisplay();
                alert('Score history cleared!');
                scoreModal.style.display = 'none';
            }
        });
        
        // Mobile Controls
        mobileButtons.forEach(button => {
            button.addEventListener('click', () => {
                const dir = button.getAttribute('data-direction');
                if (gameRunning && !gamePaused) {
                    // Prevent 180-degree turns
                    if ((dir === 'up' && direction !== 'down') ||
                        (dir === 'down' && direction !== 'up') ||
                        (dir === 'left' && direction !== 'right') ||
                        (dir === 'right' && direction !== 'left')) {
                        nextDirection = dir;
                    }
                }
            });
        });
        
        // Keyboard Controls
        document.addEventListener('keydown', (e) => {
            // Close modals with ESC
            if (e.key === 'Escape') {
                if (settingsModal.style.display === 'flex') {
                    settingsModal.style.display = 'none';
                } else if (scoreModal.style.display === 'flex') {
                    scoreModal.style.display = 'none';
                } else if (menuPanel.classList.contains('active')) {
                    toggleMenu();
                }
            }
            
            // Fullscreen toggle
            if (e.key === 'F11') {
                e.preventDefault();
                toggleFullscreen();
            }
            
            // Pause toggle
            if (e.key === 'p' || e.key === 'P') {
                pauseBtn.click();
            }
            
            if (!gameRunning || gamePaused) return;
            
            // Prevent default behavior for arrow keys
            if ([37, 38, 39, 40].includes(e.keyCode)) {
                e.preventDefault();
            }
            
            // Change direction (prevent 180-degree turns)
            switch(e.key) {
                case 'ArrowUp':
                case 'w':
                case 'W':
                    if (direction !== 'down') nextDirection = 'up';
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                    if (direction !== 'up') nextDirection = 'down';
                    break;
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    if (direction !== 'right') nextDirection = 'left';
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    if (direction !== 'left') nextDirection = 'right';
                    break;
            }
        });
        
        // Fullscreen change handler
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                // Return to normal view
            }
        });
        
        // ============================
        // INITIALIZATION
        // ============================
        
        function init() {
            // Load saved settings
            const savedSettings = localStorage.getItem('snakeSettings');
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    soundSlider.value = settings.soundVolume || 70;
                    musicSlider.value = settings.musicVolume || 50;
                    speedSlider.value = settings.gameSpeed || 90;
                    gameSpeed = parseInt(speedSlider.value);
                } catch (e) {
                    console.log('Error loading settings:', e);
                }
            }
            
            // Load high score
            highScoreElement.textContent = highScore;
            
            // Update settings display
            updateSettingsDisplay();
            
            // Load score history
            updateScoreHistoryDisplay();
            
            // Draw initial screen
            draw();
            
            // Set default difficulty
            const defaultDifficulty = document.querySelector('.difficulty-btn.active');
            gameSpeed = parseInt(defaultDifficulty.getAttribute('data-speed'));
            speedSlider.value = gameSpeed;
            updateSettingsDisplay();
            
            console.log('Neon Snake 3D - Premium Edition Loaded Successfully!');
        }
        
        // Start the game
        init();
    </script>
</body>
</html>